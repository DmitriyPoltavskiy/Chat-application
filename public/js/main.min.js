function chatCtrl(e,t){var o=this,a=t(),n=new firebase.auth.FacebookAuthProvider,r=new firebase.auth.TwitterAuthProvider,s=new firebase.auth.GithubAuthProvider;o.messages=e.getMessages(),o.shownMessages=e.limitMessages(),o.sendMessage=function(){if(null!=o.author){var t={authorMessage:o.author.displayName=null==o.author.displayName?"New user":o.author.displayName,authorId:o.author.uid,authorPhoto:o.author.displayName=null==o.author.displayName?"https://pp.vk.me/c637316/v637316077/223f8/ikCaKUp3uJs.jpg":o.author.displayName,text:o.newMessage};""!=o.newMessage?(e.sendMessage(t),o.newMessage="",$(".chat-footer-message").removeClass("absentText")):($(".chat-footer-message").focus(),$(".chat-footer-message").addClass("absentText"))}else alert("You are not login!")},o.login=function(){a.$signInWithPopup("google")},o.loginF=function(){a.$signInWithPopup(n)},o.loginT=function(){a.$signInWithPopup(r)},o.loginG=function(){a.$signInWithPopup(s).then(function(e){var t=e.credential.accessToken;console.log("token: "+t);var o=e.user;console.log("user: "+o)}).catch(function(e){var t=e.code;console.log("errorCode: "+t);var o=e.message;console.log("errorMessage: "+o);var a=e.email;console.log("email: "+a);var n=e.credential;console.log("credential: "+n)})},o.logout=function(){a.$signOut()},a.$onAuthStateChanged(function(e){console.log(e),o.author=e})}function chatService(e){var t=firebase.database().ref().child("messages"),o={};return o.getMessages=function(){return e(t)},o.sendMessage=function(e){o.getMessages().$add(e)},o.limitMessages=function(){return e(t.limitToLast(20))},o}function clickToSend(){return function(e,t,o){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(o.sendDirective)}),t.preventDefault())})}}var config={apiKey:"AIzaSyCq4m6rjQA8NROOK-VT2IOUww8bv374gZg",authDomain:"chatapp-2b28b.firebaseapp.com",databaseURL:"https://chatapp-2b28b.firebaseio.com",storageBucket:"chatapp-2b28b.appspot.com",messagingSenderId:"577030966423"};firebase.initializeApp(config),angular.module("chatApp",["firebase","ngRoute"]).config(["$routeProvider",function(e){e.otherwise({redirectTo:"/home"}).when("/home",{templateUrl:"home.html",controller:"homeCtrl"}).when("/chat",{templateUrl:"chat.html",controller:"chatCtrl"})}]),angular.module("chatApp").controller("chatCtrl",["ChatService","$firebaseAuth",chatCtrl]),angular.module("chatApp").factory("ChatService",["$firebaseArray",chatService]),angular.module("chatApp").directive("sendDirective",[clickToSend]),angular.module("chatApp").controller("homeCtrl",["$scope","$firebaseAuth","firebase",function(e,t,o,a){e.SignIn=function(){var t=e.user.email,a=e.user.password;console.log("username: "+t),console.log("password: "+a),o.User.displayName="her",console.log(o.User.displayName),o.auth().signInWithEmailAndPassword(t,a).then(function(e){console.log("result: "+e),window.location.href="/#!/chat"}).catch(function(e){var t=e.code,o=e.message;"auth/wrong-password"===t?alert("Wrong password."):alert(o),console.log(e)})}}]),angular.module("chatApp").directive("scrollTo",function(){return{restrict:"A",link:function(){$(".chat-message").ready(function(){var e=document.getElementById("scrollHeight").scrollHeight;$(".chat-body").scrollTo(e)})}}}),angular.module("chatApp").directive("pressKey",function(){return{restrict:"A",link:function(){$(document).keydown(function(){$(".chat-footer-message").focus()})}}}),angular.module("chatApp").directive("isAuth",["$firebaseAuth",function(e){return{restrict:"A",link:function(){var t,o=e();o.$onAuthStateChanged(function(e){t=e,null!=e?window.location.href="/#!/chat":window.location.href="/#!/home"})}}}]);